---
- name: Ensure repository for brave-browser is present
  ansible.builtin.copy:
    dest: /etc/yum.repos.d/brave-browser.repo
    content: |
      [brave-browser]
      name=Brave Browser
      enabled=1
      autorefresh=1
      baseurl=https://brave-browser-rpm-release.s3.brave.com/$basearch
    owner: root
    group: root
    mode: 0644
  become: true

- name: Ensure repository for Hashicorp is present
  ansible.builtin.copy:
    dest: /etc/yum.repos.d/hashicorp.repo
    content: |
      [hashicorp]
      name=Hashicorp Stable Repository
      enabled=1
      gpgcheck=1
      gpgkey=https://rpm.releases.hashicorp.com/gpg
      baseurl=https://rpm.releases.hashicorp.com/fedora/$releasever/$basearch/stable
    owner: root
    group: root
    mode: 0644
  become: true

- name: Ensure rpm key for brave-browser is present
  ansible.builtin.rpm_key:
    key: https://brave-browser-rpm-release.s3.brave.com/brave-core.asc
    state: present
  become: true

- name: Ensure rpm key for Visual Studio Code is present
  ansible.builtin.rpm_key:
    key: https://packages.microsoft.com/keys/microsoft.asc
    state: absent
  become: true

- name: Ensure base dnf packages are present
  ansible.builtin.dnf:
    name: "{{ base_packages }}"
    state: present
  become: true

- name: Ensure libvirt support for Vagrant is present
  ansible.builtin.dnf:
    name: "{{ vagrant_libvirt_packages }}"
    state: present
  become: true
  when: "'vagrant' | string in base_packages"
